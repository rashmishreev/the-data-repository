(this["webpackJsonpcampus-app-v2"]=this["webpackJsonpcampus-app-v2"]||[]).push([[3],{2097:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return o}));var r=n(2147),i=n(1934);function s(t,e,n,s,o,u,a,c){void 0===a&&(a=0);var h,p=0;return Object(r.a)(t,(function(){if(n.isEmpty()&&!h)return Promise.resolve();var r="number"===typeof(h=n.pop(h)).length?h.length+" "+o:o;t[c?"debug":"info"](i.ac,[r]);var s=JSON.stringify(u?u(h):h);return a||(h=void 0),e(s).then((function(){p=0,h=void 0})).catch((function(e){a?p===a?(p=0,h=void 0,t[c?"debug":"warn"](i.bc,[r,e])):(p++,t[c?"debug":"warn"](i.dc,[r,e])):t[c?"debug":"warn"](i.bc,[r,e])}))}),s,o+" submitter")}function o(t,e){var n,r=!1,i=t.start;t.start=function(){r=!0,n=setTimeout(i,e)};var s=t.stop;return t.stop=function(){r=!1,clearTimeout(n),s()},t.isRunning=function(){return r},t}},2098:function(t,e,n){"use strict";n.d(e,"j",(function(){return i})),n.d(e,"f",(function(){return s})),n.d(e,"g",(function(){return o})),n.d(e,"i",(function(){return u})),n.d(e,"h",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return h})),n.d(e,"k",(function(){return p})),n.d(e,"l",(function(){return l})),n.d(e,"m",(function(){return f})),n.d(e,"a",(function(){return m})),n.d(e,"e",(function(){return g})),n.d(e,"b",(function(){return r}));var r,i=600,s="PUSH_NONRETRYABLE_ERROR",o="PUSH_RETRYABLE_ERROR",u="PUSH_SUBSYSTEM_UP",a="PUSH_SUBSYSTEM_DOWN",c="MY_SEGMENTS_UPDATE",h="MY_SEGMENTS_UPDATE_V2",p="SEGMENT_UPDATE",l="SPLIT_KILL",f="SPLIT_UPDATE",m="CONTROL",g="OCCUPANCY";!function(t){t.STREAMING_DISABLED="STREAMING_DISABLED",t.STREAMING_PAUSED="STREAMING_PAUSED",t.STREAMING_RESUMED="STREAMING_RESUMED",t.STREAMING_RESET="STREAMING_RESET"}(r||(r={}))},2147:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1934);function i(t,e,n,i){void 0===i&&(i="task");var s,o,u,a=0,c=!1,h=0;function p(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return a++,t.debug(r.pc,[i]),s=(s?s.then((function(){return e.apply(void 0,n)})):e.apply(void 0,n)).then((function(t){return a--,t}))}function l(t){return p.apply(void 0,o).then((function(e){return c&&t===h&&(u=setTimeout(l,n,t)),e}))}return{execute:p,isExecuting:function(){return a>0},start:function(){for(var e=[],s=0;s<arguments.length;s++)e[s]=arguments[s];if(!c)return c=!0,h++,o=e,t.debug(r.qc,[i,n]),l(h)},stop:function(){c=!1,u&&(t.debug(r.rc,[i]),clearTimeout(u),u=void 0)},isRunning:function(){return c}}}},2201:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var r=n(2338),i=n(2340),s=n(2342),o=n(2346),u=n(2343),a=n(1946),c=n(2474),h=n(2347);function p(t){var e=t.settings,n=e.scheduler,p=n.impressionsQueueSize,l=n.eventsQueueSize,f=e.sync,m=f.impressionsMode,g=f.__splitFiltersValidation,d=new r.a(g),y=new i.a,v={splits:d,segments:y,impressions:new s.a(p),impressionCounts:m!==a.m?new u.a:void 0,events:new o.a(l),telemetry:Object(c.b)(t)?new c.a(d,y):void 0,uniqueKeys:m===a.G?new h.a:void 0,destroy:function(){this.splits.clear(),this.segments.clear(),this.impressions.clear(),this.impressionCounts&&this.impressionCounts.clear(),this.events.clear(),this.uniqueKeys&&this.uniqueKeys.clear()},shared:function(){return{splits:this.splits,segments:new i.a,impressions:this.impressions,impressionCounts:this.impressionCounts,events:this.events,telemetry:this.telemetry,destroy:function(){this.splits=new r.a(g),this.segments.clear()}}}};if(t.settings.mode===a.D){var S=function(){return!0};v.impressions.track=S,v.events.track=S,v.impressionCounts&&(v.impressionCounts.track=S),v.uniqueKeys&&(v.uniqueKeys.track=S)}return v}p.type=a.bb},2334:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u}));var r=n(1942),i=n(2097),s=n(1934);function o(t,e){var n=Object(r.f)(e,"feature"),i=[];return Object(r.d)(n,(function(e,n){i.push({f:n,i:e.map((function(e){return{k:e.keyName,t:e.treatment,m:e.time,c:e.changeNumber,r:t?e.label:void 0,b:e.bucketingKey?e.bucketingKey:void 0,pt:e.pt?e.pt:void 0}}))})})),i}function u(t){var e=t.settings,n=e.log,r=e.scheduler.impressionsRefreshRate,u=e.core.labelsEnabled,a=t.splitApi.postTestImpressionsBulk,c=t.storage.impressions,h=Object(i.b)(n,a,c,r,"impressions",o.bind(void 0,u),1);return c.setOnFullQueueCb((function(){h.isRunning()&&(n.info(s.cc,["impressions"]),h.execute())})),h}},2335:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var r=n(2097);function i(t){for(var e=[],n=Object.keys(t),r=0;r<n.length;r++){var i=n[r].split("::");if(2===i.length){var s=i[0],o=i[1],u={f:s,m:Number(o),rc:t[n[r]]};e.push(u)}}return{pf:e}}function s(t){var e=t.settings.log,n=t.splitApi.postTestImpressionsCount,s=t.storage.impressionCounts;if(s)return Object(r.b)(e,n,s,18e5,"impression counts",i,1)}},2338:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2066),i=n(2339),s=n(1942),o=n(2028),u=function(t){function e(e){var n=t.call(this)||this;return n.splitsCache={},n.ttCache={},n.changeNumber=-1,n.splitsWithSegmentsCount=0,n.flagSetsCache={},n.flagSetsFilter=e?e.groupedFilters.bySet:[],n}return Object(r.a)(e,t),e.prototype.clear=function(){this.splitsCache={},this.ttCache={},this.changeNumber=-1,this.splitsWithSegmentsCount=0},e.prototype.addSplit=function(t,e){var n=this.getSplit(t);if(n){var r=n.trafficTypeName;this.ttCache[r]--,this.ttCache[r]||delete this.ttCache[r],this.removeFromFlagSets(n.name,n.sets),Object(i.b)(n)&&this.splitsWithSegmentsCount--}if(e){this.splitsCache[t]=e;var s=e.trafficTypeName;return this.ttCache[s]=(this.ttCache[s]||0)+1,this.addToFlagSets(e),Object(i.b)(e)&&this.splitsWithSegmentsCount++,!0}return!1},e.prototype.removeSplit=function(t){var e=this.getSplit(t);if(e){delete this.splitsCache[t];var n=e.trafficTypeName;return this.ttCache[n]--,this.ttCache[n]||delete this.ttCache[n],this.removeFromFlagSets(e.name,e.sets),Object(i.b)(e)&&this.splitsWithSegmentsCount--,!0}return!1},e.prototype.getSplit=function(t){return this.splitsCache[t]||null},e.prototype.setChangeNumber=function(t){return this.changeNumber=t,!0},e.prototype.getChangeNumber=function(){return this.changeNumber},e.prototype.getSplitNames=function(){return Object.keys(this.splitsCache)},e.prototype.trafficTypeExists=function(t){return Object(s.h)(this.ttCache[t])&&this.ttCache[t]>0},e.prototype.usesSegments=function(){return-1===this.getChangeNumber()||this.splitsWithSegmentsCount>0},e.prototype.getNamesByFlagSets=function(t){var e=this;return t.map((function(t){return e.flagSetsCache[t]||new o.a}))},e.prototype.addToFlagSets=function(t){var e=this;t.sets&&t.sets.forEach((function(n){e.flagSetsFilter.length>0&&!e.flagSetsFilter.some((function(t){return t===n}))||(e.flagSetsCache[n]||(e.flagSetsCache[n]=new o.a([])),e.flagSetsCache[n].add(t.name))}))},e.prototype.removeFromFlagSets=function(t,e){var n=this;e&&e.forEach((function(e){n.removeNames(e,t)}))},e.prototype.removeNames=function(t,e){this.flagSetsCache[t]&&(this.flagSetsCache[t].delete(e),0===this.flagSetsCache[t].size&&delete this.flagSetsCache[t])},e}(i.a)},2339:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var r=n(1956),i=function(){function t(){}return t.prototype.addSplits=function(t){var e=this;return t.map((function(t){return e.addSplit(t[0],t[1])}))},t.prototype.removeSplits=function(t){var e=this;return t.map((function(t){return e.removeSplit(t)}))},t.prototype.getSplits=function(t){var e=this,n={};return t.forEach((function(t){n[t]=e.getSplit(t)})),n},t.prototype.getAll=function(){var t=this;return this.getSplitNames().map((function(e){return t.getSplit(e)}))},t.prototype.checkCache=function(){return!1},t.prototype.killLocally=function(t,e,n){var i=this.getSplit(t);if(i&&(!i.changeNumber||i.changeNumber<n)){var s=Object(r.a)({},i);return s.killed=!0,s.defaultTreatment=e,s.changeNumber=n,this.addSplit(t,s)}return!1},t}();function s(t){for(var e=t.conditions||[],n=0;n<e.length;n++)for(var r=e[n].matcherGroup.matchers,i=0;i<r.length;i++)if("IN_SEGMENT"===r[i].matcherType)return!0;return!1}},2340:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2066),i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.segmentCache={},e}return Object(r.a)(e,t),e.prototype.clear=function(){this.segmentCache={}},e.prototype.addToSegment=function(t){return this.segmentCache[t]=!0,!0},e.prototype.removeFromSegment=function(t){return delete this.segmentCache[t],!0},e.prototype.isInSegment=function(t){return!0===this.segmentCache[t]},e.prototype.resetSegments=function(t){var e,n=this,r=!1,i=Object.keys(this.segmentCache);if(0===t.length&&i.length===t.length)return r;if(i.length!==t.length)r=!0,this.segmentCache={},t.forEach((function(t){n.addToSegment(t)}));else{for(e=0;e<t.length&&this.isInSegment(t[e]);e++);e<t.length&&(r=!0,this.segmentCache={},t.forEach((function(t){n.addToSegment(t)})))}return r},e.prototype.getRegisteredSegments=function(){return Object.keys(this.segmentCache)},e.prototype.getKeysCount=function(){return 1},e}(n(2341).a)},2341:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(){}return t.prototype.registerSegments=function(t){return!1},t.prototype.setChangeNumber=function(t,e){return!0},t.prototype.getChangeNumber=function(t){return-1},t.prototype.resetSegments=function(t){return!0},t}()},2342:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(t){void 0===t&&(t=0),this.maxQueue=t,this.queue=[]}return t.prototype.setOnFullQueueCb=function(t){this.onFullQueue=t},t.prototype.track=function(t){var e;(e=this.queue).push.apply(e,t),this.maxQueue>0&&this.queue.length>=this.maxQueue&&this.onFullQueue&&this.onFullQueue()},t.prototype.clear=function(){this.queue=[]},t.prototype.pop=function(t){var e=this.queue;return this.clear(),t?t.concat(e):e},t.prototype.isEmpty=function(){return 0===this.queue.length},t}()},2343:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(2345),i=n(2344),s=function(){function t(t){void 0===t&&(t=i.a),this.cache={},this.cacheSize=0,this.maxStorage=t}return t.prototype._makeKey=function(t,e){return t+"::"+Object(r.a)(e)},t.prototype.track=function(t,e,n){var r=this._makeKey(t,e),i=this.cache[r];this.cache[r]=i?i+n:n,this.onFullQueue&&(this.cacheSize=this.cacheSize+n,this.cacheSize>=this.maxStorage&&this.onFullQueue())},t.prototype.pop=function(t){var e=this.cache;return this.clear(),t?(Object.keys(e).forEach((function(n){t[n]?t[n]+=e[n]:t[n]=e[n]})),t):e},t.prototype.clear=function(){this.cache={},this.cacheSize=0},t.prototype.isEmpty=function(){return 0===Object.keys(this.cache).length},t}()},2344:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=3e4},2346:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){function t(t){void 0===t&&(t=0),this.maxQueue=t,this.queue=[],this.queueByteSize=0}return t.prototype.setOnFullQueueCb=function(t){this.onFullQueue=t},t.prototype.track=function(t,e){return void 0===e&&(e=0),this.queueByteSize+=e,this.queue.push(t),this._checkForFlush(),!0},t.prototype.clear=function(){this.queue=[],this.queueByteSize=0},t.prototype.pop=function(t){var e=this.queue;return this.clear(),t?t.concat(e):e},t.prototype.isEmpty=function(){return 0===this.queue.length},t.prototype._checkForFlush=function(){(this.queueByteSize>5242880||this.maxQueue>0&&this.queue.length>=this.maxQueue)&&this.onFullQueue&&this.onFullQueue()},t}()},2347:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(2028),i=n(2344),s=function(){function t(t){void 0===t&&(t=i.a),this.uniqueTrackerSize=0,this.uniqueKeysTracker={},this.maxStorage=t}return t.prototype.setOnFullQueueCb=function(t){this.onFullQueue=t},t.prototype.track=function(t,e){this.uniqueKeysTracker[t]||(this.uniqueKeysTracker[t]=new r.a);var n=this.uniqueKeysTracker[t];n.has(e)||(n.add(e),this.uniqueTrackerSize++),this.uniqueTrackerSize>=this.maxStorage&&this.onFullQueue&&this.onFullQueue()},t.prototype.clear=function(){this.uniqueTrackerSize=0,this.uniqueKeysTracker={}},t.prototype.pop=function(){var t=this.uniqueKeysTracker;return this.clear(),this.fromUniqueKeysCollector(t)},t.prototype.isEmpty=function(){return 0===Object.keys(this.uniqueKeysTracker).length},t.prototype.fromUniqueKeysCollector=function(t){for(var e=[],n=Object.keys(t),i=0;i<n.length;i++){var s=n[i],o={k:s,fs:Object(r.c)(t[s])};e.push(o)}return{keys:e}},t}()},2474:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n(1946),i=n(1942);function s(t){var e=Math.min(22,Math.max(0,Math.ceil(Math.log(t)/Math.log(1.5))));return Object(i.i)(e)?0:e}function o(t){var e=t.settings;return e.mode!==r.D&&(void 0===e.core.key||Math.random()<=.001)}var u=function(){function t(t,e){this.splits=t,this.segments=e,this.e=!0,this.notReadyUsage=0,this.impressionStats=[0,0,0],this.eventStats=[0,0],this.lastSync={},this.httpErrors={},this.httpLatencies={},this.authRejections=0,this.tokenRefreshes=0,this.streamingEvents=[],this.tags=[],this.exceptions={},this.latencies={},this.updatesFromSSE={sp:0,ms:0}}return t.prototype.isEmpty=function(){return this.e},t.prototype.clear=function(){},t.prototype.pop=function(){return this.e=!0,{lS:this.getLastSynchronization(),mL:this.popLatencies(),mE:this.popExceptions(),hE:this.popHttpErrors(),hL:this.popHttpLatencies(),tR:this.popTokenRefreshes(),aR:this.popAuthRejections(),iQ:this.getImpressionStats(r.Q),iDe:this.getImpressionStats(r.o),iDr:this.getImpressionStats(r.q),spC:this.splits&&this.splits.getSplitNames().length,seC:this.segments&&this.segments.getRegisteredSegments().length,skC:this.segments&&this.segments.getKeysCount(),sL:this.getSessionLength(),eQ:this.getEventStats(r.Q),eD:this.getEventStats(r.q),sE:this.popStreamingEvents(),t:this.popTags(),ufs:this.popUpdatesFromSSE()}},t.prototype.getTimeUntilReady=function(){return this.timeUntilReady},t.prototype.recordTimeUntilReady=function(t){this.timeUntilReady=t},t.prototype.getTimeUntilReadyFromCache=function(){return this.timeUntilReadyFromCache},t.prototype.recordTimeUntilReadyFromCache=function(t){this.timeUntilReadyFromCache=t},t.prototype.getNonReadyUsage=function(){return this.notReadyUsage},t.prototype.recordNonReadyUsage=function(){this.notReadyUsage++},t.prototype.getImpressionStats=function(t){return this.impressionStats[t]},t.prototype.recordImpressionStats=function(t,e){this.impressionStats[t]+=e,this.e=!1},t.prototype.getEventStats=function(t){return this.eventStats[t]},t.prototype.recordEventStats=function(t,e){this.eventStats[t]+=e,this.e=!1},t.prototype.getLastSynchronization=function(){return this.lastSync},t.prototype.recordSuccessfulSync=function(t,e){this.lastSync[t]=e,this.e=!1},t.prototype.popHttpErrors=function(){var t=this.httpErrors;return this.httpErrors={},t},t.prototype.recordHttpError=function(t,e){var n=this.httpErrors[t]=this.httpErrors[t]||{};n[e]=(n[e]||0)+1,this.e=!1},t.prototype.popHttpLatencies=function(){var t=this.httpLatencies;return this.httpLatencies={},t},t.prototype.recordHttpLatency=function(t,e){(this.httpLatencies[t]=this.httpLatencies[t]||[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])[s(e)]++,this.e=!1},t.prototype.popAuthRejections=function(){var t=this.authRejections;return this.authRejections=0,t},t.prototype.recordAuthRejections=function(){this.authRejections++,this.e=!1},t.prototype.popTokenRefreshes=function(){var t=this.tokenRefreshes;return this.tokenRefreshes=0,t},t.prototype.recordTokenRefreshes=function(){this.tokenRefreshes++,this.e=!1},t.prototype.popStreamingEvents=function(){return this.streamingEvents.splice(0)},t.prototype.recordStreamingEvents=function(t){this.streamingEvents.length<20&&this.streamingEvents.push(t),this.e=!1},t.prototype.popTags=function(){return this.tags.splice(0)},t.prototype.addTag=function(t){this.tags.length<10&&this.tags.push(t),this.e=!1},t.prototype.getSessionLength=function(){return this.sessionLength},t.prototype.recordSessionLength=function(t){this.sessionLength=t,this.e=!1},t.prototype.popExceptions=function(){var t=this.exceptions;return this.exceptions={},t},t.prototype.recordException=function(t){this.exceptions[t]=(this.exceptions[t]||0)+1,this.e=!1},t.prototype.popLatencies=function(){var t=this.latencies;return this.latencies={},t},t.prototype.recordLatency=function(t,e){(this.latencies[t]=this.latencies[t]||[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])[s(e)]++,this.e=!1},t.prototype.popUpdatesFromSSE=function(){var t=this.updatesFromSSE;return this.updatesFromSSE={sp:0,ms:0},t},t.prototype.recordUpdatesFromSSE=function(t){this.updatesFromSSE[t]++,this.e=!1},t}()},2508:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1956),i=function(){function t(){this.attributesCache={}}return t.prototype.setAttribute=function(t,e){return this.attributesCache[t]=e,!0},t.prototype.getAttribute=function(t){return this.attributesCache[t]},t.prototype.setAttributes=function(t){return this.attributesCache=Object(r.a)(this.attributesCache,t),!0},t.prototype.getAll=function(){return this.attributesCache},t.prototype.removeAttribute=function(t){return Object.keys(this.attributesCache).indexOf(t)>=0&&(delete this.attributesCache[t],!0)},t.prototype.clear=function(){return this.attributesCache={},!0},t}()},2983:function(t,e,n){"use strict";n.d(e,"a",(function(){return I}));var r=n(1956),i=n(2149),s=n(2098),o=n(1942);var u=n(1946),a=[/control_pri$/,/control_sec$/],c=[u.J,u.K];var h=n(1934);function p(t,e,n){var r=function(t,e){var n=a.map((function(t){return{regex:t,hasPublishers:!0,oTime:-1,cTime:-1}})),r=!0,i=!0;return{handleOpen:function(){e.streamingEvent(u.c),t.emit(s.i)},isStreamingUp:function(){return i&&r},handleOccupancyEvent:function(o,u,a){for(var h=0;h<n.length;h++){var p=n[h];if(p.regex.test(u)){if(e.streamingEvent(c[h],o),a>p.oTime){p.oTime=a,p.hasPublishers=0!==o;var l=n.some((function(t){return t.hasPublishers}));i&&(!l&&r?t.emit(s.h):l&&!r&&t.emit(s.i)),r=l}return}}},handleControlEvent:function(o,a,c){if(o!==s.b.STREAMING_RESET)for(var h=0;h<n.length;h++){var p=n[h];if(p.regex.test(a))return void(c>p.cTime&&(p.cTime=c,o===s.b.STREAMING_DISABLED?(e.streamingEvent(u.eb,u.p),t.emit(s.f)):r&&(o===s.b.STREAMING_PAUSED&&i?(e.streamingEvent(u.eb,u.N),t.emit(s.h)):o!==s.b.STREAMING_RESUMED||i||(e.streamingEvent(u.eb,u.r),t.emit(s.i))),i=o===s.b.STREAMING_RESUMED))}else t.emit(o)}}}(e,n);return{handleOpen:function(){r.handleOpen()},handleError:function(r){var i=r;try{i=function(t){return Object(o.k)(t.data)&&(t.parsedData=JSON.parse(t.data)),t}(r)}catch(c){t.warn(h.Ub,[c])}var a=i.parsedData&&i.parsedData.message||i.message;t.error(h.gb,[a]),!function(t){if(t.parsedData&&t.parsedData.code){var e=t.parsedData.code;if(n.streamingEvent(u.a,e),40140<=e&&e<=40149)return!0;if(4e4<=e&&e<=49999)return!1}else n.streamingEvent(u.X,u.I);return!0}(i)?e.emit(s.f):e.emit(s.g)},handleMessage:function(n){var i;try{if(!(i=function(t){if(t.data){var e=JSON.parse(t.data);return e.parsedData=JSON.parse(e.data),e.name&&"[meta]occupancy"===e.name&&(e.parsedData.type=s.e),e}}(n)))return}catch(p){return void t.warn(h.Vb,[p])}var o=i.parsedData,u=i.data,a=i.channel,c=i.timestamp;if(t.debug(h.Tb,[u]),r.isStreamingUp()||-1!==[s.e,s.a].indexOf(o.type))switch(o.type){case s.m:case s.k:case s.d:case s.l:e.emit(o.type,o);break;case s.c:e.emit(o.type,o,a);break;case s.e:r.handleOccupancyEvent(o.metrics.publishers,a,c);break;case s.a:r.handleControlEvent(o.controlType,a,c)}}}}function l(t,e){var n,r,s=0,o=-1,a=!1,c=new i.a(h);function h(){if(n=!0,s>o){a=!1;var i=s;t.execute(r,!0).then((function(t){n&&(!1!==t&&(r&&e.trackUpdatesFromSSE(u.E),o=Math.max(o,i)),a?h():c.scheduleCall())}))}else n=!1}return{put:function(t,e){t<=o||t<=s||(s=t,a=!0,r=e,!c.timeoutID&&n||h(),c.reset())},stop:function(){n=!1,c.reset()}}}function f(t,e,n){var r={};return{put:function(s){var o=s.changeNumber,u=s.segmentName;r[u]||(r[u]=function(r){var s,o,u=0,a=!1,c=new i.a(h,1e4,6e4);function h(){s=!0,u>n.getChangeNumber(r)?(a=!1,e.execute(!1,r,!0,o?u:void 0).then((function(){if(s)if(a)h();else{var e=c.attempts+1;if(u<=n.getChangeNumber(r))return t.debug("Refresh completed"+(o?" bypassing the CDN":"")+" in "+e+" attempts."),void(s=!1);if(e<10)return void c.scheduleCall();o?(t.debug("No changes fetched after "+e+" attempts with CDN bypassed."),s=!1):(c.reset(),o=!0,h())}}))):s=!1}return{put:function(t){t<=n.getChangeNumber(r)||t<=u||(u=t,a=!0,o=!1,!c.timeoutID&&s||h(),c.reset())},stop:function(){s=!1,c.reset()}}}(u)),r[u].put(o)},stop:function(){Object.keys(r).forEach((function(t){return r[t].stop()}))}}}var m=n(1995);var g=n(2200),d=n(2504),y=n(2148);function v(t){return Object(g.b)(Object(y.b)(t,0).toString())}var S=/^control_/;var b,k,E=function(){function t(t,e,n){if(this.eventSource=n&&n(),!this.eventSource)throw new Error("EventSource API is not available. ");this.streamingUrl=t.urls.streaming+"/sse",this.useHeaders=e,this.headers=function(t){var e={SplitSDKClientKey:Object(o.k)(t.core.authorizationKey)?t.core.authorizationKey.slice(-4):"",SplitSDKVersion:t.version},n=t.runtime,r=n.ip,i=n.hostname;return r&&(e.SplitSDKMachineIP=r),i&&(e.SplitSDKMachineName=i),e}(t)}return t.prototype.setEventHandler=function(t){this.handler=t},t.prototype.open=function(t){this.close();var e=Object.keys(t.channels).map((function(t){var e=S.test(t)?"[?occupancy=metrics.publishers]":"";return encodeURIComponent(e+t)})).join(","),n=this.streamingUrl+"?channels="+e+"&accessToken="+t.token+"&v=1.1&heartbeats=true";this.connection=new this.eventSource(this.useHeaders?n:n+"&SplitSDKVersion="+this.headers.SplitSDKVersion+"&SplitSDKClientKey="+this.headers.SplitSDKClientKey,this.useHeaders?{headers:this.headers}:void 0),this.handler&&(this.connection.addEventListener("open",this.handler.handleOpen),this.connection.addEventListener("message",this.handler.handleMessage),this.connection.addEventListener("error",this.handler.handleError))},t.prototype.close=function(){this.connection&&this.connection.close()},t}(),C=n(2068);!function(t){t[t.None=0]="None",t[t.Gzip=1]="Gzip",t[t.Zlib=2]="Zlib"}(b||(b={})),function(t){t[t.UnboundedFetchRequest=0]="UnboundedFetchRequest",t[t.BoundedFetchRequest=1]="BoundedFetchRequest",t[t.KeyList=2]="KeyList",t[t.SegmentRemoval=3]="SegmentRemoval"}(k||(k={}));var O=n(2505);function T(t,e){var n=function(t){var e=t.split("").map((function(t){return t.charCodeAt(0)}));return new Uint8Array(e)}(Object(g.a)(t));if("string"===typeof O.a)throw new Error(O.a);if(1===e)return O.a.gunzipSync(n);if(2===e)return O.a.unzlibSync(n);throw new Error("Invalid compression algorithm #"+e)}function R(t,e,n){void 0===n&&(n=!0);var r,i=T(t,e),s=(r=i,String.fromCharCode.apply(null,r));return n&&(s=s.replace(/\d+/g,'"$&"')),JSON.parse(s)}var N=n(2028),j=n(3030);function I(t,e){var n,a=t.settings,c=t.storage,y=t.splitApi,S=t.readiness,b=t.platform,O=t.telemetryTracker,I=a.core.key?Object(C.b)(a.core.key):void 0,K=a.log;try{n=new E(a,!I,b.getEventSource)}catch(W){return void K.warn(h.Sb,[W])}var F,w=(F=y.fetchAuth,function(t){return F(t).then((function(t){return t.json()})).then((function(t){if(t.token){var e=Object(d.a)(t.token);if("number"!==typeof e.iat||"number"!==typeof e.exp)throw new Error('token properties "issuedAt" (iat) or "expiration" (exp) are missing or invalid');var n=JSON.parse(e["x-ably-capability"]);return Object(r.a)({decodedToken:e,channels:n},t)}return t}))}),x=new b.EventEmitter,U=p(K,x,O);n.setEventHandler(U);var A,_,M,D,P=I?void 0:f(K,e.segmentsSyncTask,c.segments),L=function(t,e,n,r,s,o){var a,c,h,p=0,l=!1,f=new i.a(g,1e4,6e4);function g(){if(a=!0,p>e.getChangeNumber()){l=!1;var r=h?{payload:h,changeNumber:p}:void 0;n.execute(!0,c?p:void 0,r).then((function(){if(a)if(l)g();else{r&&s.trackUpdatesFromSSE(u.S),o&&o.execute(!0);var n=f.attempts+1;if(p<=e.getChangeNumber())return t.debug("Refresh completed"+(c?" bypassing the CDN":"")+" in "+n+" attempts."),void(a=!1);if(n<10)return void f.scheduleCall();c?(t.debug("No changes fetched after "+n+" attempts with CDN bypassed."),a=!1):(f.reset(),c=!0,g())}}))}else a=!1}function d(t,n){var r=t.changeNumber,i=t.pcn,s=e.getChangeNumber();r<=s||r<=p||(p=r,l=!0,c=!1,h=void 0,n&&s===i&&(h=n),!f.timeoutID&&a||g(),f.reset())}return{put:d,killSplit:function(t){var n=t.changeNumber,i=t.splitName,s=t.defaultTreatment;e.killLocally(i,s,n)&&r.emit(m.e,!0),d({changeNumber:n})},stop:function(){a=!1,f.reset()}}}(K,c.splits,e.splitsSyncTask,S.splits,O,I?void 0:e.segmentsSyncTask),q={},H={},Q=!1,z=new i.a(B,a.scheduler.pushRetryBackoffBase);function B(){if(!A){K.info(h.Pb),A=!1;var t=I?Object.keys(H):void 0;w(t).then((function(e){if(!A)return e.pushEnabled?void(t&&t.length<Object.keys(H).length||function(t){M&&clearTimeout(M),D&&clearTimeout(D);var e=t.decodedToken,r=e.exp-e.iat-s.j,i="number"===typeof t.connDelay&&t.connDelay>=0?t.connDelay:60;K.info(h.Zb,[r,i]),M=setTimeout(B,1e3*r),D=setTimeout((function(){A||n.open(t)}),1e3*i),O.streamingEvent(u.ib,e.exp)}(e)):(K.info(h.Qb),void x.emit(s.f))})).catch((function(t){if(!A){if(K.error(h.fb,[t.message]),t.statusCode>=400&&t.statusCode<500)return O.streamingEvent(u.b),void x.emit(s.f);x.emit(s.g)}}))}}function G(){A||(A=!0,n.close(),K.info(h.Rb),M&&clearTimeout(M),D&&clearTimeout(D),z.reset(),J())}function J(){L.stop(),I?Object(o.d)(H,(function(t){return t.worker.stop()})):P.stop()}return x.on(s.h,J),x.on(s.i,(function(){z.reset()})),x.on(s.f,(function(){_=!0,G(),x.emit(s.h)})),x.on(s.g,(function(){n.close();var t=z.scheduleCall();K.info(h.Yb,[t/1e3]),x.emit(s.h)})),x.on(s.b.STREAMING_RESET,(function(){A||(M&&clearTimeout(M),B())})),x.on(s.l,L.killSplit),x.on(s.m,(function(t){if(t.d&&void 0!==t.c)try{var e=(n=t.c,r=t.d,n>0?R(r,n,!1):JSON.parse(Object(g.a)(r)));if(e)return void L.put(t,e)}catch(W){K.warn(h.Xb,[W])}var n,r;L.put(t)})),I?(x.on(s.c,(function(t,e){var n=e.split("_")[2],r=q[n];r&&H[r]&&H[r].worker.put(t.changeNumber,t.includesPayload?t.segmentList?t.segmentList:[]:void 0)})),x.on(s.d,(function(t){switch(t.u){case k.BoundedFetchRequest:var e;try{s=t.d,u=t.c,e=T(s,u)}catch(W){K.warn(h.Wb,["BoundedFetchRequest",W]);break}return void Object(o.d)(H,(function(n){var r=n.hash64,i=n.worker;(function(t,e){var n=parseInt(e.slice(8),16)%(8*t.length),r=n%8;return(t[Math.floor(n/8)]&1<<r)>0})(e,r.hex)&&i.put(t.changeNumber)}));case k.KeyList:var n,r,i=void 0;try{i=R(t.d,t.c),n=new N.a(i.a),r=new N.a(i.r)}catch(W){K.warn(h.Wb,["KeyList",W]);break}return void Object(o.d)(H,(function(e){var i=e.hash64,s=e.worker,o=!!n.has(i.dec)||!r.has(i.dec)&&void 0;void 0!==o&&s.put(t.changeNumber,{name:t.segmentName,add:o})}));case k.SegmentRemoval:if(!t.segmentName){K.warn(h.Wb,["SegmentRemoval","No segment name was provided"]);break}return void Object(o.d)(H,(function(e){return e.worker.put(t.changeNumber,{name:t.segmentName,add:!1})}))}var s,u;Object(o.d)(H,(function(e){e.worker.put(t.changeNumber)}))}))):x.on(s.k,P.put),Object(r.a)(Object.create(x),{stop:function(){G(),I&&this.remove(I)},start:function(){_||!1===A||(A=!1,I?this.add(I,e.segmentsSyncTask):setTimeout(B))},isRunning:function(){return!1===A},add:function(t,e){var n=v(t);q[n]||(q[n]=t,H[t]={hash64:Object(j.a)(t),worker:l(e,O)},Q=!0,setTimeout((function(){Q&&(Q=!1,B())}),0))},remove:function(t){var e=v(t);delete q[e],delete H[t]}})}},2989:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(1942),i=n(2147);var s=n(2337),o=n(1995),u=n(1934);function a(t,e,n,r,i,a,c,h){var p=!0,l=!0;function f(t){return l&&(t=Object(s.a)(a,t)),t}function m(t){var e;if(Array.isArray(t))e=r.resetSegments(t);else{var s=t.name,u=t.add;r.isInSegment(s)!==u?(e=!0,u?r.addToSegment(s):r.removeFromSegment(s)):e=!1}n.usesSegments()&&(e||p)&&(p=!1,i.emit(o.d))}return function(n,r){return function n(r,i,s){return(i?new Promise((function(t){m(i),t(!0)})):e(h,s,f).then((function(t){return l=!1,m(t),!0}))).catch((function(e){return l&&c>r?(r+=1,t.warn(u.fc,[r,e]),n(r)):(l=!1,!1)}))}(0,n,r)}}var c=n(2028);function h(t,e){var n=new c.a,i=t.reduce((function(t,i){return"ACTIVE"===i.status&&function(t,e){var n=e.groupedFilters,i=n.bySet,s=n.byName,o=n.byPrefix;if(i.length>0)return t.sets&&t.sets.some((function(t){return i.indexOf(t)>-1}));var u=s.length>0,a=o.length>0;if(!u&&!a)return!0;var c=u&&s.indexOf(t.name)>-1,h=a&&o.some((function(e){return Object(r.m)(t.name,e)}));return c||h}(i,e)?(t.added.push([i.name,i]),function(t){for(var e=t.conditions,n=new c.a,r=0;r<e.length;r++){e[r].matcherGroup.matchers.forEach((function(t){"IN_SEGMENT"===t.matcherType&&n.add(t.userDefinedSegmentMatcherData.segmentName)}))}return n}(i).forEach((function(t){n.add(t)}))):t.removed.push(i.name),t}),{added:[],removed:[],segments:[]});return i.segments=Object(c.c)(n),i}function p(t,e,n,r,i,a,c,p,l){void 0===c&&(c=0),void 0===p&&(p=0);var f=!0;function m(t){return f&&c&&(t=Object(s.a)(c,t)),t}return function(s,c,g){return Promise.resolve(n.getChangeNumber()).then((function d(y,v){void 0===v&&(v=0),t.debug(u.hc,[y]);var S=Promise.resolve(g?{splits:[g.payload],till:g.changeNumber}:e(y,s,c,m)).then((function(e){f=!1;var s=h(e.splits,i);return t.debug(u.kc,[s.added.length]),t.debug(u.lc,[s.removed.length]),t.debug(u.mc,[s.segments.length]),Promise.all([n.setChangeNumber(e.till),n.addSplits(s.added),n.removeSplits(s.removed),r.registerSegments(s.segments)]).then((function(t){return!a||Promise.resolve(!a.splitsArrived||y!==e.till&&function(t){var e=t[1],n=t[2];return!(!e||!e.some((function(t){return t})))||!(!n||!n.some((function(t){return t})))}(t)&&(l||function(t){return Promise.resolve(t.getRegisteredSegments()).then((function(e){return Promise.all(e.map((function(e){return t.getChangeNumber(e)}))).then((function(t){return t.every((function(t){return-1!==t}))}))}))}(r))).catch((function(){return!1})).then((function(t){return t&&a.emit(o.e),!0}))}))})).catch((function(e){return t.warn(u.ic,[e]),f&&p>v?(v+=1,t.info(u.jc,[v,e]),d(y,v)):(f=!1,!1)}));return a&&f&&Promise.resolve(n.checkCache()).then((function(t){t&&a.emit(o.f)})),S}))}}var l=n(2068);function f(t){var e=t.splitApi,n=t.storage,s=t.readiness,c=t.settings,h=c.log,f=function(t,e,n,r,s){return Object(i.a)(r.log,p(r.log,function(t){return function(e,n,r,i){var s=t(e,n,r);return i&&(s=i(s)),s.then((function(t){return t.json()}))}}(t),e.splits,e.segments,r.sync.__splitFiltersValidation,n.splits,r.startup.requestTimeoutBeforeReady,r.startup.retriesOnFailureBeforeReady,s),r.scheduler.featuresRefreshRate,"splitChangesUpdater")}(e.fetchSplitChanges,n,s,c,!0),m={},g=v(Object(l.b)(c.core.key),s,n);function d(){Object(r.d)(m,(function(t){t.start()}))}function y(){Object(r.d)(m,(function(t){t.isRunning()&&t.stop()}))}function v(t,n,r){var s=function(t,e,n,r,s){return Object(i.a)(r.log,a(r.log,function(t){return function(e,n,r){var i=t(e,n);return r&&(i=r(i)),i.then((function(t){return t.json()})).then((function(t){return t.mySegments.map((function(t){return t.name}))}))}}(t),e.splits,e.segments,n.segments,r.startup.requestTimeoutBeforeReady,r.startup.retriesOnFailureBeforeReady,s),r.scheduler.segmentsRefreshRate,"mySegmentsUpdater")}(e.fetchMySegments,r,n,c,t);function u(){n.isReady()||r.splits.usesSegments()||n.segments.emit(o.d)}return r.splits.usesSegments()?n.splits.once(o.e,u):setTimeout(u,0),m[t]=s,s}return s.splits.on(o.e,(function(){if(f.isRunning()){var t=n.splits.usesSegments();t!==g.isRunning()&&(h.info(u.Ib,[t?"ON":"OFF"]),t?d():y())}})),{splitsSyncTask:f,segmentsSyncTask:g,start:function(){h.info(u.Jb),f.start(),n.splits.usesSegments()&&d()},stop:function(){h.info(u.Kb),f.isRunning()&&f.stop(),y()},isRunning:f.isRunning,syncAll:function(){var t=[f.execute()];return Object(r.d)(m,(function(e){t.push(e.execute())})),Promise.all(t)},add:v,remove:function(t){delete m[t]},get:function(t){return m[t]}}}},2991:function(t,e,n){"use strict";n.d(e,"a",(function(){return R}));var r=n(2342),i=n(2343),s=n(2346),o=n(1942),u=n(2148),a=/[^.]+$/;var c=function(){function t(t){void 0===t&&(t="SPLITIO"),this.prefix=t}return t.prototype.buildTrafficTypeKey=function(t){return this.prefix+".trafficType."+t},t.prototype.buildFlagSetKey=function(t){return this.prefix+".flagSet."+t},t.prototype.buildSplitKey=function(t){return this.prefix+".split."+t},t.prototype.buildSplitsTillKey=function(){return this.prefix+".splits.till"},t.prototype.isSplitKey=function(t){return Object(o.m)(t,this.prefix+".split.")},t.prototype.buildSplitKeyPrefix=function(){return this.prefix+".split."},t.prototype.buildSplitsWithSegmentCountKey=function(){return this.prefix+".splits.usingSegments"},t.prototype.buildSegmentNameKey=function(t){return this.prefix+".segment."+t},t.prototype.buildSegmentTillKey=function(t){return this.prefix+".segment."+t+".till"},t.prototype.extractKey=function(t){var e=t.match(a);if(e&&e.length)return e[0];throw new Error("Invalid latency key provided")},t.prototype.buildHashKey=function(){return this.prefix+".hash"},t}();var h=n(2066),p=function(t){function e(e,n){var r=t.call(this,e)||this;return r.matchingKey=n,r.regexSplitsCacheKey=new RegExp("^"+e+"\\.(splits?|trafficType|flagSet)\\."),r}return Object(h.a)(e,t),e.prototype.buildSegmentNameKey=function(t){return this.prefix+"."+this.matchingKey+".segment."+t},e.prototype.extractSegmentName=function(t){var e=this.prefix+"."+this.matchingKey+".segment.";if(Object(o.m)(t,e))return t.substr(e.length)},e.prototype.buildOldSegmentNameKey=function(t){return this.matchingKey+"."+this.prefix+".segment."+t},e.prototype.extractOldSegmentKey=function(t){var e=this.matchingKey+"."+this.prefix+".segment.";if(Object(o.m)(t,e))return t.substr(e.length)},e.prototype.buildLastUpdatedKey=function(){return this.prefix+".splits.lastUpdated"},e.prototype.isSplitsCacheKey=function(t){return this.regexSplitsCacheKey.test(t)},e}(c),l=n(2194),f=n(2339),m="storage:localstorage: ",g=n(2028),d=function(t){function e(e,n,r){var i=t.call(this)||this;return i.keys=n,i.log=e.log,i.storageHash=function(t){return Object(u.b)(t.core.authorizationKey+"::"+t.sync.__splitFiltersValidation.queryString).toString(16)}(e),i.flagSetsFilter=e.sync.__splitFiltersValidation.groupedFilters.bySet,i._checkExpiration(r),i._checkFilterQuery(),i}return Object(h.a)(e,t),e.prototype._decrementCount=function(t){var e=Object(o.o)(localStorage.getItem(t))-1;e>0?localStorage.setItem(t,e):localStorage.removeItem(t)},e.prototype._decrementCounts=function(t){try{if(t){var e=this.keys.buildTrafficTypeKey(t.trafficTypeName);if(this._decrementCount(e),Object(f.b)(t)){var n=this.keys.buildSplitsWithSegmentCountKey();this._decrementCount(n)}}}catch(r){this.log.error(m+r)}},e.prototype._incrementCounts=function(t){try{if(t){var e=this.keys.buildTrafficTypeKey(t.trafficTypeName);if(localStorage.setItem(e,Object(o.o)(localStorage.getItem(e))+1),Object(f.b)(t)){var n=this.keys.buildSplitsWithSegmentCountKey();localStorage.setItem(n,Object(o.o)(localStorage.getItem(n))+1)}}}catch(r){this.log.error(m+r)}},e.prototype.clear=function(){this.log.info(m+"Flushing Splits data from localStorage");for(var t=localStorage.length,e=[],n=0;n<t;n++){var r=localStorage.key(n);null!=r&&this.keys.isSplitsCacheKey(r)&&e.push(r)}e.forEach((function(t){localStorage.removeItem(t)})),this.hasSync=!1},e.prototype.addSplit=function(t,e){try{var n=this.keys.buildSplitKey(t),r=localStorage.getItem(n),i=r?JSON.parse(r):null;return localStorage.setItem(n,JSON.stringify(e)),this._incrementCounts(e),this._decrementCounts(i),i&&this.removeFromFlagSets(i.name,i.sets),this.addToFlagSets(e),!0}catch(s){return this.log.error(m+s),!1}},e.prototype.removeSplit=function(t){try{var e=this.getSplit(t);return localStorage.removeItem(this.keys.buildSplitKey(t)),this._decrementCounts(e),e&&this.removeFromFlagSets(e.name,e.sets),!0}catch(n){return this.log.error(m+n),!1}},e.prototype.getSplit=function(t){var e=localStorage.getItem(this.keys.buildSplitKey(t));return e&&JSON.parse(e)},e.prototype.setChangeNumber=function(t){if(this.updateNewFilter){this.log.info(m+"SDK key or feature flag filter criteria was modified. Updating cache");var e=this.keys.buildHashKey();try{localStorage.setItem(e,this.storageHash)}catch(n){this.log.error(m+n)}this.updateNewFilter=!1}try{return localStorage.setItem(this.keys.buildSplitsTillKey(),t+""),localStorage.setItem(this.keys.buildLastUpdatedKey(),Date.now()+""),this.hasSync=!0,!0}catch(n){return this.log.error(m+n),!1}},e.prototype.getChangeNumber=function(){var t=localStorage.getItem(this.keys.buildSplitsTillKey());return null!==t?(t=parseInt(t,10),Object(o.i)(t)?-1:t):-1},e.prototype.getSplitNames=function(){for(var t=localStorage.length,e=[],n=0;n<t;){var r=localStorage.key(n);null!=r&&this.keys.isSplitKey(r)&&e.push(this.keys.extractKey(r)),n++}return e},e.prototype.trafficTypeExists=function(t){var e=Object(o.o)(localStorage.getItem(this.keys.buildTrafficTypeKey(t)));return Object(o.h)(e)&&e>0},e.prototype.usesSegments=function(){if(!this.hasSync)return!0;var t=localStorage.getItem(this.keys.buildSplitsWithSegmentCountKey()),e=null===t?0:Object(o.o)(t);return!Object(o.h)(e)||e>0},e.prototype.checkCache=function(){return this.getChangeNumber()>-1},e.prototype._checkExpiration=function(t){var e=localStorage.getItem(this.keys.buildLastUpdatedKey());null!==e&&(e=parseInt(e,10),!Object(o.i)(e)&&t&&e<t&&this.clear())},e.prototype._checkFilterQuery=function(){var t=this.keys.buildHashKey();if(localStorage.getItem(t)!==this.storageHash)try{this.updateNewFilter=!0,this.checkCache()&&this.clear()}catch(e){this.log.error(m+e)}},e.prototype.getNamesByFlagSets=function(t){var e=this;return t.map((function(t){var n=e.keys.buildFlagSetKey(t),r=localStorage.getItem(n);return new g.a(r?JSON.parse(r):[])}))},e.prototype.addToFlagSets=function(t){var e=this;t.sets&&t.sets.forEach((function(n){if(!(e.flagSetsFilter.length>0)||e.flagSetsFilter.some((function(t){return t===n}))){var r=e.keys.buildFlagSetKey(n),i=localStorage.getItem(r),s=new g.a(i?JSON.parse(i):[]);s.add(t.name),localStorage.setItem(r,JSON.stringify(Object(g.c)(s)))}}))},e.prototype.removeFromFlagSets=function(t,e){var n=this;e&&e.forEach((function(e){n.removeNames(e,t)}))},e.prototype.removeNames=function(t,e){var n=this.keys.buildFlagSetKey(t),r=localStorage.getItem(n);if(r){var i=new g.a(JSON.parse(r));i.delete(e),0!==i.size?localStorage.setItem(n,JSON.stringify(Object(g.c)(i))):localStorage.removeItem(n)}},e}(f.a),y=function(t){function e(e,n){var r=t.call(this)||this;return r.log=e,r.keys=n,r}return Object(h.a)(e,t),e.prototype.clear=function(){this.log.info(m+"Flushing MySegments data from localStorage"),this.resetSegments([])},e.prototype.addToSegment=function(t){var e=this.keys.buildSegmentNameKey(t);try{return localStorage.setItem(e,"1"),!0}catch(n){return this.log.error(m+n),!1}},e.prototype.removeFromSegment=function(t){var e=this.keys.buildSegmentNameKey(t);try{return localStorage.removeItem(e),!0}catch(n){return this.log.error(m+n),!1}},e.prototype.isInSegment=function(t){return"1"===localStorage.getItem(this.keys.buildSegmentNameKey(t))},e.prototype.resetSegments=function(t){var e,n=this,r=!1,i=Object.keys(localStorage).reduce((function(e,r){var i=n.keys.extractSegmentName(r);if(i)e.push(i);else if(i=n.keys.extractOldSegmentKey(r)){var s=n.keys.buildSegmentNameKey(i);try{!localStorage.getItem(s)&&t.indexOf(i)>-1&&(localStorage.setItem(s,"1"),e.push(i)),localStorage.removeItem(r)}catch(o){n.log.error(o)}}return e}),[]);if(0===t.length&&i.length===t.length)return r;if(i.length!==t.length)r=!0,i.forEach((function(t){return n.removeFromSegment(t)})),t.forEach((function(t){return n.addToSegment(t)}));else{for(e=0;e<t.length&&-1!==i.indexOf(t[e]);e++);e<t.length&&(r=!0,i.forEach((function(t){return n.removeFromSegment(t)})),t.forEach((function(t){return n.addToSegment(t)})))}return r},e.prototype.getRegisteredSegments=function(){var t=this;return Object.keys(localStorage).reduce((function(e,n){var r=t.keys.extractSegmentName(n);return r&&e.push(r),e}),[])},e.prototype.getKeysCount=function(){return 1},e}(n(2341).a),v=n(2340),S=n(2338),b=n(2195),k=n(2201),E=n(1946),C=n(2474),O=n(2347),T=n(2068);function R(t){void 0===t&&(t={});var e=function(t){return t?t+".SPLITIO":"SPLITIO"}(t.prefix);function n(t){if(!Object(l.a)())return t.settings.log.warn(m+"LocalStorage API is unavailable. Falling back to default MEMORY storage"),Object(k.a)(t);var n=t.settings,o=t.settings,u=o.log,a=o.scheduler,c=a.impressionsQueueSize,h=a.eventsQueueSize,f=o.sync,g=f.impressionsMode,R=f.__splitFiltersValidation,N=Object(T.b)(n.core.key),j=new p(e,N),I=Date.now()-b.a,K=new d(n,j,I),F=new y(u,j);return{splits:K,segments:F,impressions:new r.a(c),impressionCounts:g!==E.m?new i.a:void 0,events:new s.a(h),telemetry:Object(C.b)(t)?new C.a(K,F):void 0,uniqueKeys:g===E.G?new O.a:void 0,destroy:function(){var t;this.splits=new S.a(R),this.segments=new v.a,this.impressions.clear(),this.impressionCounts&&this.impressionCounts.clear(),this.events.clear(),null===(t=this.uniqueKeys)||void 0===t||t.clear()},shared:function(t){var n=new p(e,t);return{splits:this.splits,segments:new y(u,n),impressions:this.impressions,impressionCounts:this.impressionCounts,events:this.events,telemetry:this.telemetry,destroy:function(){this.splits=new S.a(R),this.segments=new v.a}}}}}return n.type=E.ab,n}},2997:function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var r=n(2097),i=n(1934);function s(t){var e=t.settings,n=e.log,s=e.scheduler.eventsPushRate,o=e.startup.eventsFirstPushWindow,u=t.splitApi.postEventsBulk,a=t.storage.events,c=Object(r.b)(n,u,a,s,"events");return o>0&&(c=Object(r.a)(c,o)),a.setOnFullQueueCb((function(){c.isRunning()&&(n.info(i.cc,["events"]),c.execute())})),c}var o,u,a,c=n(2334),h=n(2335),p=n(1946),l=n(1995),f=n(2473),m=n(2199),g=n(2336),d=n(1956),y=((o={})[p.Z]=p.Y,o[p.h]=p.g,o[p.j]=p.i,o),v=((u={})[p.L]=p.M,u[p.m]=p.n,u[p.G]=p.H,u),S=((a={})[p.f]=1,a[p.e]=2,a[p.d]=3,a);function b(t,e){return{isEmpty:function(){return!1},clear:function(){},pop:function(){var n,r,i=e.urls,s=e.scheduler,o=void 0!==e.core.key,u=function(t){var e=0;t.validFilters.forEach((function(t){"bySet"===t.type&&(e+=t.values.length)}));var n=t.groupedFilters.bySet.length;return{flagSetsTotal:e,flagSetsIgnored:e-n}}(e.sync.__splitFiltersValidation),a=u.flagSetsTotal,c=u.flagSetsIgnored;return Object(d.a)((n=e.mode,r=e.storage.type,{oM:y[n],st:r.toLowerCase(),aF:Object.keys(m.b).length,rF:Object.keys(m.b).reduce((function(t,e){return t+m.b[e]-1}),0)}),{sE:e.streamingEnabled,rR:{sp:s.featuresRefreshRate/1e3,se:o?void 0:s.segmentsRefreshRate/1e3,ms:o?s.segmentsRefreshRate/1e3:void 0,im:s.impressionsRefreshRate/1e3,ev:s.eventsPushRate/1e3,te:s.telemetryRefreshRate/1e3},uO:{s:i.sdk!==f.a.urls.sdk,e:i.events!==f.a.urls.events,a:i.auth!==f.a.urls.auth,st:i.streaming!==f.a.urls.streaming,t:i.telemetry!==f.a.urls.telemetry},iQ:s.impressionsQueueSize,eQ:s.eventsQueueSize,iM:v[e.sync.impressionsMode],iL:!!e.impressionListener,hP:!1,tR:t.getTimeUntilReady(),tC:t.getTimeUntilReadyFromCache(),nR:t.getNonReadyUsage(),t:t.popTags(),i:e.integrations&&e.integrations.map((function(t){return t.type})),uC:e.userConsent?S[e.userConsent]:0,fsT:a,fsI:c})}}}function k(t){var e=[Object(c.b)(t),s(t)],n=Object(h.b)(t);n&&e.push(n);var o=function(t){var e=t.storage.telemetry,n=t.platform.now;if(e&&n){var i=t.settings,s=t.settings,o=s.log,u=s.scheduler.telemetryRefreshRate,a=t.splitApi,c=t.readiness,h=t.sdkReadinessManager,p=Object(g.a)(n),f=Object(r.a)(Object(r.b)(o,a.postMetricsUsage,e,u,"telemetry stats",void 0,0,!0),u);return c.gate.once(l.b,(function(){e.recordTimeUntilReadyFromCache(p())})),h.incInternalReadyCbCount(),c.gate.once(l.a,(function(){(e.recordTimeUntilReady(p()),f.isRunning())&&Object(r.b)(o,a.postMetricsConfig,b(e,i),0,"telemetry config",void 0,0,!0).execute()})),f}}(t);return t.storage.uniqueKeys&&e.push(function(t){var e=t.settings,n=e.log,s=e.core.key,o=t.splitApi,u=o.postUniqueKeysBulkCs,a=o.postUniqueKeysBulkSs,c=t.storage.uniqueKeys,h=void 0!==s?u:a,p=Object(r.b)(n,h,c,9e5,"unique keys");return c.setOnFullQueueCb((function(){p.isRunning()&&(n.info(i.cc,["unique keys"]),p.execute())})),p}(t)),{start:function(t){t||e.forEach((function(t){return t.start()})),o&&o.start()},stop:function(t){e.forEach((function(t){return t.stop()})),!t&&o&&o.stop()},isRunning:function(){return e.some((function(t){return t.isRunning()}))},execute:function(t){var n=t?[]:e.map((function(t){return t.execute()}));return o&&n.push(o.execute()),Promise.all(n)},isExecuting:function(){return e.some((function(t){return t.isExecuting()}))}}}var E=n(2098),C=n(2198);function O(t,e){return function(n){var r=n.settings,s=n.settings,o=s.log,u=s.streamingEnabled,a=s.sync.enabled,c=n.telemetryTracker,h=t&&t(n),l=a&&u&&h&&e?e(n,h):void 0,f=k(n);l&&(l.on(E.i,(function(){o.info(i.oc),h.isRunning()&&(h.stop(),c.streamingEvent(p.fb,p.db)),h.syncAll()})),l.on(E.h,(function(){h.isRunning()?o.info(i.ec):(o.info(i.nc),h.start(),c.streamingEvent(p.fb,p.O))})));var m=!1,g=!0;return{pollingManager:h,pushManager:l,submitterManager:f,start:function(){m=!0,h&&(a?l?(g&&(h.syncAll(),g=!1),l.start()):h.start():g&&(h.syncAll(),g=!1)),f.start(!Object(C.a)(r))},stop:function(){m=!1,l&&l.stop(),h&&h.isRunning()&&h.stop(),f.stop()},isRunning:function(){return m},flush:function(){return f.execute(!Object(C.a)(r))},shared:function(t,e,n){if(h){var r=h.add(t,e,n);return{isRunning:r.isRunning,start:function(){a?l?(h.isRunning()?n.splits.usesSegments()&&r.start():r.execute(),l.add(t,r)):n.splits.usesSegments()&&r.start():e.isReady()||r.execute()},stop:function(){var e=h.get(t);e&&(l&&l.remove(t),e.isRunning()&&e.stop(),h.remove(t))},flush:function(){return Promise.resolve()}}}}}}}},2999:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var r=n(1942);function i(t){var e=t.treatment;return t.keys?{conditionType:"WHITELIST",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"WHITELIST",negate:!1,whitelistMatcherData:{whitelist:Object(r.k)(t.keys)?[t.keys]:t.keys}}]},partitions:[{treatment:e,size:100}],label:"whitelisted "+e}:{conditionType:"ROLLOUT",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"ALL_KEYS",negate:!1}]},partitions:[{treatment:e,size:100}],label:"default rule"}}var s=n(2147),o=n(1946),u=n(1995),a=n(1934);function c(t,e,n,i){return Object(s.a)(i.log,function(t,e,n,i){var s=i.log,c=e.splits,h=!0;return function(){var e=[],p=null,l={};try{l=t(i)}catch(f){p=f,s.error(a.hb,[f])}return!p&&l?(s.debug(a.gc,[JSON.stringify(l)]),Object(r.d)(l,(function(t,n){e.push([n,{name:n,status:"ACTIVE",killed:!1,trafficAllocation:100,defaultTreatment:o.k,conditions:t.conditions||[],configurations:t.configurations,trafficTypeName:t.trafficTypeName}])})),Promise.all([c.clear(),c.addSplits(e)]).then((function(){return n.splits.emit(u.e),h&&(h=!1,Promise.resolve(c.checkCache()).then((function(t){t&&n.splits.emit(u.f),n.segments.emit(u.d)}))),!0}))):Promise.resolve(!0)}}(t,e,n,i),i.scheduler.offlineRefreshRate,"offlineUpdater")}var h=n(1956);function p(){return Promise.resolve()}var l,f=(l=function(){var t={emptyMock:"1"};return function(e){var n=e.features||{};if(!function(e){var n=Object.keys(e);return n.length!==Object.keys(t).length?(t=e,!0):n.some((function(n){var r,i,s=!t[n],o=(r=t[n],i=e[n],typeof r!==typeof i||("string"===typeof r?r!==i:r.treatment!==i.treatment||r.config!==i.config)),u=s||o;return u&&(t=e),u}))}(n))return!1;var s={};return Object(r.d)(n,(function(t,e){var n=t,o=null;Object(r.j)(t)&&(n=t.treatment,o=t.config||o);var u={};null!==o&&(u[n]=o),s[e]={trafficTypeName:"localhost",conditions:[i({treatment:n})],configurations:u}})),s}},function(t){var e=t.settings,n=t.readiness,r=t.storage;return Object(h.a)(c(l(),r,n,e),{flush:p,shared:function(t,e){return{start:function(){setTimeout((function(){e.segments.emit(u.d)}),0)},stop:function(){},isRunning:function(){return!0},flush:p}}})});function m(){return f}f.type="LocalhostFromObject"},3027:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1956),i=n(1934);var s=n(1946),o={headers:{"Cache-Control":"no-cache"}};function u(t){return"users="+encodeURIComponent(t)}function a(t,e,n){var a=t.urls,c=t.sync.__splitFiltersValidation&&t.sync.__splitFiltersValidation.queryString,h=t.sync.impressionsMode,p=function(t,e){var n=t.log,s=t.core.authorizationKey,o=t.version,u=t.runtime,a=u.ip,c=u.hostname,h=e&&e();h||n.error(i.H,["Global fetch API is not available."]);var p={Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s,SplitSDKVersion:o};return a&&(p.SplitSDKMachineIP=a),c&&(p.SplitSDKMachineName=c),function(t,e,s,o){void 0===e&&(e={}),void 0===s&&(s=function(){}),void 0===o&&(o=!1);var u={headers:e.headers?Object(r.a)({},p,e.headers):p,method:e.method||"GET",body:e.body};return h?h(t,u).then((function(t){return t.ok?(s(),t):t.text().then((function(e){return Promise.reject({response:t,message:e})}))})).catch((function(e){var r=e&&e.response,u="";if(r)switch(r.status){case 404:u="Invalid SDK key or resource not found.";break;default:u=e.message}else u=e.message||"Network Error";r&&403===r.status||n[o?"info":"error"](i.P,[r?r.status:"NO_STATUS",t,u]);var a=new Error(u);throw a.statusCode=r&&r.status,s(a),a})):Promise.reject(new Error("Global fetch API is not available."))}}(t,e.getFetch);return{getSdkAPIHealthCheck:function(){var t=a.sdk+"/version";return p(t).then((function(){return!0})).catch((function(){return!1}))},getEventsAPIHealthCheck:function(){var t=a.events+"/version";return p(t).then((function(){return!0})).catch((function(){return!1}))},fetchAuth:function(t){var e=a.auth+"/v2/auth";if(t){var r=t.map(u).join("&");r&&(e+="?"+r)}return p(e,void 0,n.trackHttp(s.hb))},fetchSplitChanges:function(e,r,u){var h=a.sdk+"/splitChanges?since="+e+(u?"&till="+u:"")+(c||"");return p(h,r?o:void 0,n.trackHttp(s.S)).catch((function(e){throw 414===e.statusCode&&t.log.error(i.jb),e}))},fetchSegmentChanges:function(t,e,r,i){var u=a.sdk+"/segmentChanges/"+e+"?since="+t+(i?"&till="+i:"");return p(u,r?o:void 0,n.trackHttp(s.R))},fetchMySegments:function(t,e){var r=a.sdk+"/mySegments/"+encodeURIComponent(t);return p(r,e?o:void 0,n.trackHttp(s.E))},postEventsBulk:function(t,e){var r=a.events+"/events/bulk";return p(r,{method:"POST",body:t,headers:e},n.trackHttp(s.s))},postTestImpressionsBulk:function(t,e){var i=a.events+"/testImpressions/bulk";return p(i,{method:"POST",body:t,headers:Object(r.a)({SplitSDKImpressionsMode:h},e)},n.trackHttp(s.B))},postTestImpressionsCount:function(t,e){var r=a.events+"/testImpressions/count";return p(r,{method:"POST",body:t,headers:e},n.trackHttp(s.C))},postUniqueKeysBulkCs:function(t,e){var r=a.telemetry+"/v1/keys/cs";return p(r,{method:"POST",body:t,headers:e},n.trackHttp(s.gb))},postUniqueKeysBulkSs:function(t,e){var r=a.telemetry+"/v1/keys/ss";return p(r,{method:"POST",body:t,headers:e},n.trackHttp(s.gb))},postMetricsConfig:function(t,e){var r=a.telemetry+"/v1/metrics/config";return p(r,{method:"POST",body:t,headers:e},n.trackHttp(s.gb),!0)},postMetricsUsage:function(t,e){var r=a.telemetry+"/v1/metrics/usage";return p(r,{method:"POST",body:t,headers:e},n.trackHttp(s.gb),!0)}}}}}]);
//# sourceMappingURL=vendors~ce~dle~dnde~ee~ge~idee~pmce~rde~splitio~ve~vise~d49b3b41.81abbc16.chunk.js.map